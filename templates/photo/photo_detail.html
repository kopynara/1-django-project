{% extends 'base.html' %} {# base.html 템플릿을 상속받습니다. #}
{% load static %} {# 정적 파일을 사용하기 위해 로드합니다. #}

{% block title %}{{ photo.title }}{% endblock %} {# 사진 제목을 페이지 제목으로 설정합니다. #}

{% block content %} {# base.html의 content 블록에 이 내용을 삽입합니다. #}
    <div class="container my-4">
        <h1 class="mb-3">{{ photo.title }}</h1> {# 사진 제목 #}
        <p class="text-muted small mb-3">
            <i class="far fa-calendar-alt"></i> {{ photo.created_at|date:"Y.m.d H:i" }}
            {% if photo.owner %} | <i class="fas fa-user"></i> {{ photo.owner }}{% endif %}
        </p>

        <div class="row mb-4">
            <div class="col-md-8 offset-md-2">
                {% if photo.image %}
                    <img src="{{ photo.image.url }}" class="img-fluid rounded-3 shadow-sm" alt="{{ photo.title }}">
                {% else %}
                    {# 이미지가 없을 경우 대체 이미지 또는 플레이스홀더 #}
                    <img src="https://placehold.co/800x600/cccccc/333333?text=No+Image" class="img-fluid rounded-3 shadow-sm" alt="No Image">
                {% endif %}
            </div>
        </div>

        {# 태그 표시 섹션 시작 #}
        {% if photo.tags.all %} {# 사진에 태그가 있다면 #}
            <div class="tags-section mb-4 text-center"> {# 태그 섹션에 아래쪽 마진을 추가합니다. #}
                <i class="fas fa-tags me-1"></i>
                {% for tag in photo.tags.all %} {# 각 태그를 순회합니다. #}
                    {# 태그 클릭 시 해당 태그가 달린 사진 목록으로 이동하는 링크 #}
                    <a href="{% url 'photo:photo_list_by_tag' tag_slug=tag.slug %}"
                       class="badge bg-info text-dark me-1 mb-1 rounded-pill">
                        {{ tag.name }}
                    </a>
                {% endfor %}
            </div>
        {% endif %}
        {# 태그 표시 섹션 끝 #}

        <div class="photo-description mb-5 text-center"> {# 사진 설명에 아래쪽 마진을 추가합니다. #}
            <p class="lead">{{ photo.description }}</p> {# 사진 설명 #}
        </div>

        <div class="d-flex justify-content-between align-items-center mb-5"> {# 버튼들을 양쪽 끝으로 정렬 #}
            {# "목록으로 돌아가기" 버튼 URL을 동적으로 변경 #}
            {% if request.GET.next == 'index' %}
                <a href="{% url 'photo:index' %}" class="btn btn-secondary">목록으로 돌아가기</a>
            {% elif request.GET.next == 'photo_archive' %} {# photo 앱에 아카이브 뷰가 있다면 #}
                <a href="{% url 'photo:photo_archive' %}" class="btn btn-secondary">목록으로 돌아가기</a>
            {% else %}
                {# 기본값: photo 앱의 인덱스 페이지로 돌아가기 #}
                <a href="{% url 'photo:index' %}" class="btn btn-secondary">목록으로 돌아가기</a>
            {% endif %}
            {# 이전/다음 사진 링크 (필요시 추가) #}
            {# <a href="#" class="btn btn-outline-primary">이전 사진</a> #}
            {# <a href="#" class="btn btn-outline-primary">다음 사진</a> #}
        </div>
    </div>
{% endblock content %}
